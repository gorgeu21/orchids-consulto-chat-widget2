<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–í–∏–¥–∂–µ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif;
    }

    :root {
      /* Base for internal layering within the iframe */
      --cw-z-base: 9990;
    }

    @keyframes fab-bounce-in {
      0% { opacity: 0; transform: scale(0.3); }
      50% { transform: scale(1.05); }
      70% { transform: scale(0.9); }
      100% { opacity: 1; transform: scale(1); }
    }

    @keyframes card-slide-up {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse-ring {
      0% { transform: scale(1); opacity: 0.5; }
      100% { transform: scale(1.5); opacity: 0; }
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .startBtn,
    .startBtn__button,
    button.startBtn__button,
    [class*="startBtn"],
    #chat24-button,
    .chat24-widget-button {
      display: none !important;
      visibility: hidden !important;
      pointer-events: none !important;
      opacity: 0 !important;
      position: fixed !important;
      left: -9999px !important;
      top: -9999px !important;
      width: 0 !important;
      height: 0 !important;
    }

    #chat24-iframe-container {
      pointer-events: auto !important;
    }

    .fab-button {
      position: fixed;
      z-index: calc(var(--cw-z-base) + 8);
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background-color: #00A8E8;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      animation: fab-bounce-in 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
      pointer-events: auto;
    }

    .fab-button:hover { transform: scale(1.1); }

    .pulse-ring {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background-color: inherit;
      animation: pulse-ring 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    .fab-icon {
      width: 32px;
      height: 32px;
      color: white;
      position: relative;
      z-index: 10;
    }

    .overlay {
      position: fixed;
      inset: 0;
      z-index: calc(var(--cw-z-base) + 7);
      background-color: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
      pointer-events: auto;
    }

    .widget-card {
      position: fixed;
      z-index: calc(var(--cw-z-base) + 9);
      width: calc(100% - 48px);
      max-width: 420px;
      background-color: #1A2332;
      border-radius: 16px;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      border: 1px solid rgba(45, 63, 82, 0.5);
      animation: card-slide-up 0.4s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
      pointer-events: auto;
    }

    /* Position presets (relative to iframe viewport) */
    body.cw-pos-bottom-right .fab-button { bottom: 24px; right: 24px; left: auto; top: auto; }
    body.cw-pos-bottom-right .widget-card { bottom: 96px; right: 24px; left: auto; top: auto; }

    body.cw-pos-bottom-left .fab-button { bottom: 24px; left: 24px; right: auto; top: auto; }
    body.cw-pos-bottom-left .widget-card { bottom: 96px; left: 24px; right: auto; top: auto; }

    body.cw-pos-top-right .fab-button { top: 24px; right: 24px; left: auto; bottom: auto; }
    body.cw-pos-top-right .widget-card { top: 96px; right: 24px; left: auto; bottom: auto; }

    body.cw-pos-top-left .fab-button { top: 24px; left: 24px; right: auto; bottom: auto; }
    body.cw-pos-top-left .widget-card { top: 96px; left: 24px; right: auto; bottom: auto; }

    .close-button {
      position: absolute;
      top: 16px;
      right: 16px;
      z-index: 10;
      padding: 8px;
      border-radius: 50%;
      background-color: rgba(45, 63, 82, 0.5);
      border: none;
      cursor: pointer;
      transition: all 0.2s;
      color: #A8B5C8;
    }

    .close-button:hover {
      background-color: rgba(45, 63, 82, 1);
      color: white;
    }

    .widget-content { padding: 20px 24px; }

    .header-section {
      display: flex;
      gap: 16px;
      margin-bottom: 24px;
      align-items: flex-start;
    }

    .avatar-container {
      position: relative;
      flex-shrink: 0;
    }

    .avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      overflow: hidden;
      border: 2px solid #2D3F52;
      background-color: #2D3F52;
    }

    .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .status-indicator {
      position: absolute;
      bottom: 4px;
      right: 4px;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background-color: #25D366;
      border: 2px solid #1A2332;
    }

    .header-text {
      flex: 1;
      padding-top: 4px;
      min-width: 0;
    }

    .widget-title {
      font-size: 20px;
      font-weight: 600;
      color: white;
      margin-bottom: 4px;
    }

    .widget-description {
      font-size: 14px;
      color: #A8B5C8;
      line-height: 1.5;
    }

    .section-title {
      font-size: 14px;
      font-weight: 500;
      color: #A8B5C8;
      margin-bottom: 12px;
    }

    .messengers-section { margin-bottom: 24px; }

    .button-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .messenger-button {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 12px 16px;
      border-radius: 12px;
      background-color: rgba(45, 63, 82, 0.3);
      border: 1px solid rgba(45, 63, 82, 0.5);
      text-decoration: none;
      cursor: pointer;
      transition: all 0.2s;
    }

    .messenger-button:hover { background-color: rgba(45, 63, 82, 0.5); }

    .messenger-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .messenger-icon {
      flex-shrink: 0;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .icon-telegram { background-color: #0088CC; }
    .icon-whatsapp { background-color: #25D366; }
    .icon-chat { background-color: #00A8E8; }

    .messenger-text-wrapper {
      flex: 1;
      min-width: 0;
    }

    .messenger-text {
      font-size: 18px;
      font-weight: 500;
      color: white;
      transition: color 0.2s;
    }

    .messenger-button:hover .messenger-text.telegram { color: #0088CC; }
    .messenger-button:hover .messenger-text.whatsapp { color: #25D366; }
    .messenger-button:hover .messenger-text.chat { color: #00A8E8; }

    .chat-status {
      font-size: 12px;
      color: #6b7280;
      margin-top: 2px;
    }

    .chat-status.error { color: #ef4444; }

    .phone-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .phone-button {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 12px 16px;
      border-radius: 12px;
      background-color: #1F2E3F;
      border: 1px solid rgba(45, 63, 82, 0.5);
      text-decoration: none;
      text-align: center;
      transition: all 0.2s;
    }

    .phone-button:hover {
      background-color: #2A3B50;
      border-color: #2D3F52;
    }

    .phone-icon {
      width: 20px;
      height: 20px;
      color: #00A8E8;
      margin-bottom: 8px;
      transition: transform 0.2s;
    }

    .phone-button:hover .phone-icon { transform: scale(1.1); }

    .phone-number {
      font-size: 16px;
      font-weight: 600;
      color: white;
      margin-bottom: 4px;
    }

    .phone-label {
      font-size: 12px;
      color: #A8B5C8;
    }

    .spinner { animation: spin 1s linear infinite; }

    @media (max-width: 640px) {
      .widget-content { padding: 16px 20px; }
      .avatar { width: 64px; height: 64px; }
      .widget-title { font-size: 18px; }
      .messenger-button { padding: 12px; }
      .messenger-icon { width: 40px; height: 40px; }
      .messenger-text { font-size: 16px; }
      .phone-number { font-size: 14px; }
    }

    body {
      min-height: 100vh;
      background: transparent;
      pointer-events: none;
    }

    [data-consultant-widget-root],
    [data-consultant-widget-root] * {
      pointer-events: auto;
    }
  </style>
</head>
<body>
  <div id="consultantWidget" data-consultant-widget-root></div>

  <script>
    (function() {
      'use strict';

      var params = new URLSearchParams(window.location.search);

      var rawInstanceId = params.get('instanceId') || params.get('instanceid') || 'default';
      var instanceId = String(rawInstanceId).replace(/[^a-zA-Z0-9_-]/g, '');
      if (!instanceId) instanceId = 'default';

      var rawPosition = params.get('position') || 'bottom-right';
      var position = String(rawPosition);
      var allowedPositions = {
        'bottom-right': true,
        'bottom-left': true,
        'top-right': true,
        'top-left': true
      };
      if (!allowedPositions[position]) position = 'bottom-right';
      document.body.classList.add('cw-pos-' + position);

      function hashString(str) {
        var hash = 0;
        for (var i = 0; i < str.length; i++) {
          hash = ((hash << 5) - hash) + str.charCodeAt(i);
          hash |= 0;
        }
        return Math.abs(hash);
      }

      // Dynamic internal z-index so multiple instances have predictable layering
        var zBase = 9000 + (hashString(instanceId) % 800);
        document.documentElement.style.setProperty('--cw-z-base', String(zBase));

        var isOpen = false;
        var isVisible = false;
        var isChatActive = false;
        var chat2deskStatus = 'idle';
        var chat2deskInitialized = false;

      var observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.addedNodes.length) {
            mutation.addedNodes.forEach(function(node) {
              if (node.nodeType === 1) {
                if (node.querySelector && node.querySelector('button.startBtn__button')) {
                  var btn = node.querySelector('button.startBtn__button');
                  btn.style.display = 'none !important';
                  btn.style.visibility = 'hidden !important';
                  console.log('[Consultant Widget] Chat2Desk button hidden');
                }
                if (node.classList && node.classList.contains('startBtn__button')) {
                  node.style.display = 'none !important';
                  node.style.visibility = 'hidden !important';
                  console.log('[Consultant Widget] Chat2Desk button hidden (direct)');
                }
              }
            });
          }
        });
      });

      observer.observe(document.body, {
        childList: true,
        subtree: true
      });

        function getRootContainer() {
          var container = document.querySelector('[data-consultant-widget-root]');
          if (!container) {
            container = document.createElement('div');
            container.setAttribute('data-consultant-widget-root', '');
            document.body.appendChild(container);

            container.onmouseenter = function() {
              window.parent.postMessage({ action: 'cw-pointer-auto' }, '*');
            };
            container.onmouseleave = function() {
              window.parent.postMessage({ action: 'cw-pointer-none' }, '*');
            };
          }

          // Make the ID unique per instance
          container.id = 'consultantWidget-' + instanceId;
          return container;
        }

      function checkClosedState() {
        try {
          var closedUntil = localStorage.getItem(CLOSE_STORAGE_KEY);
          if (closedUntil) {
            var closedTime = parseInt(closedUntil, 10);
            if (Date.now() < closedTime) return true;
            localStorage.removeItem(CLOSE_STORAGE_KEY);
          }
        } catch (e) {
          console.warn('localStorage –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:', e);
        }
        return false;
      }

      function initChat2Desk() {
        if (chat2deskInitialized) return;
        chat2deskInitialized = true;

        console.log('[Chat2Desk] –ù–∞—á–∞–ª–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏');
        chat2deskStatus = 'loading';
        updateWidget();

        window.chat24_token = "904b449f7d66ed0b9657aa6892433165";
        window.chat24_url = "https://livechatv2.chat2desk.com";
        window.chat24_socket_url = "wss://livechatv2.chat2desk.com/widget_ws_new";
        window.chat24_static_files_domain = "https://storage.chat2desk.com/";
        window.chat24_start_hidden = true;
        window.lang = "ru";

        var timeout = setTimeout(function() {
          if (chat2deskStatus === 'loading') {
            console.error('[Chat2Desk] –¢–∞–π–º–∞—É—Ç –∑–∞–≥—Ä—É–∑–∫–∏ (30 —Å–µ–∫)');
            chat2deskStatus = 'error';
            updateWidget();
          }
        }, 30000);

        console.log('[Chat2Desk] –ó–∞–≥—Ä—É–∑–∫–∞ manifest.json...');
        fetch(window.chat24_url + "/packs/manifest.json?nocache=" + new Date().getTime())
          .then(function(res) {
            console.log('[Chat2Desk] manifest.json –∑–∞–≥—Ä—É–∂–µ–Ω');
            return res.json();
          })
          .then(function(data) {
            console.log('[Chat2Desk] –ó–∞–≥—Ä—É–∑–∫–∞ application.js:', data["application.js"]);
            var chat24Script = document.createElement("script");
            chat24Script.type = "text/javascript";
            chat24Script.async = true;
            chat24Script.src = window.chat24_url + data["application.js"];

            chat24Script.onload = function() {
              clearTimeout(timeout);
              console.log('[Chat2Desk] application.js –∑–∞–≥—Ä—É–∂–µ–Ω');

              setTimeout(function() {
                chat2deskStatus = 'ready';
                updateWidget();
                console.log('[Chat2Desk] ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –í–∏–¥–∂–µ—Ç –≥–æ—Ç–æ–≤.');
                console.log('[Chat2Desk] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª–µ–π —Å–æ–±—ã—Ç–∏—è "popups:open"...');

                var testEvent = new CustomEvent('popups:open');
                console.log('[Chat2Desk] –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ:', testEvent);
              }, 2000);
            };

            chat24Script.onerror = function() {
              clearTimeout(timeout);
              console.error('[Chat2Desk] ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ application.js');
              chat2deskStatus = 'error';
              updateWidget();
            };

            document.body.appendChild(chat24Script);
          })
          .catch(function(err) {
            clearTimeout(timeout);
            console.error('[Chat2Desk] ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ manifest.json:', err);
            chat2deskStatus = 'error';
            updateWidget();
          });
      }

          function openChat2Desk() {
            console.log('[Chat2Desk] üîµ –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–∫—Ä—ã—Ç—å —á–∞—Ç. –°—Ç–∞—Ç—É—Å:', chat2deskStatus);

            if (chat2deskStatus !== 'ready') {
              console.warn('[Chat2Desk] ‚ö†Ô∏è –í–∏–¥–∂–µ—Ç –Ω–µ –≥–æ—Ç–æ–≤. –û–∂–∏–¥–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏...');
              return;
            }

            // Tell parent to enable pointer-events permanently while chat is open
            window.parent.postMessage({ action: 'cw-chat-open' }, '*');

            console.log('[Chat2Desk] –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏—è "popups:open"');
            document.dispatchEvent(new CustomEvent('popups:open'));

            setTimeout(function() {
              var chatContainer = document.getElementById('chat24-iframe-container');
              if (chatContainer) {
                chatContainer.style.display = 'block';
                chatContainer.style.visibility = 'visible';
                chatContainer.style.pointerEvents = 'auto';
                console.log('[Chat2Desk] ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–∞—Ç–∞ –ø–æ–∫–∞–∑–∞–Ω');
              }

              var chatButtons = document.querySelectorAll('.startBtn, .startBtn__button, button.startBtn__button, [class*="startBtn__button"]');
              chatButtons.forEach(function(btn) {
                btn.style.display = 'none';
                btn.style.visibility = 'hidden';
                btn.style.pointerEvents = 'none';
              });
              console.log('[Chat2Desk] ‚úÖ –ö–Ω–æ–ø–∫–∏ Chat2Desk —Å–∫—Ä—ã—Ç—ã:', chatButtons.length);

              isOpen = false;
              updateWidget();
            }, 300);
          }

          function handleClose() {
            isOpen = false; // Stay as FAB when closed
            updateWidget();
          }

      function toggleOpen() {
        isOpen = !isOpen;
        updateWidget();
      }

          function updateWidget() {
            var container = getRootContainer();
            if (!container) return;

            if (!isVisible) {
              container.innerHTML = '';
              return;
            }

            if (!isOpen) {
              container.innerHTML = '\
                <button class="fab-button" onclick="window.consultantWidgetToggle()" aria-label="–û—Ç–∫—Ä—ã—Ç—å –≤–∏–¥–∂–µ—Ç">\
                  <div class="pulse-ring"></div>\
                  <div class="fab-icon">\
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>\
                    </svg>\
                  </div>\
                </button>';
            } else {
          var chatIconContent = chat2deskStatus === 'loading'
            ? '<svg class="spinner" style="width:24px;height:24px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" opacity="0.25"/><path d="M12 2a10 10 0 0 1 10 10" stroke-linecap="round"/></svg>'
            : chat2deskStatus === 'error'
              ? '<svg style="width:24px;height:24px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>'
              : '<svg style="width:24px;height:24px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>';

          var chatStatus = chat2deskStatus === 'loading'
            ? '<div class="chat-status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>'
            : chat2deskStatus === 'error'
              ? '<div class="chat-status error">–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</div>'
              : '';

          container.innerHTML = '\
            <div class="overlay" onclick="window.consultantWidgetClose()"></div>\
            <div class="widget-card">\
              <button class="close-button" onclick="window.consultantWidgetClose()" aria-label="–ó–∞–∫—Ä—ã—Ç—å –≤–∏–¥–∂–µ—Ç">\
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\
                  <line x1="18" y1="6" x2="6" y2="18"></line>\
                  <line x1="6" y1="6" x2="18" y2="18"></line>\
                </svg>\
              </button>\
              <div class="widget-content">\
                <div class="header-section">\
                  <div class="avatar-container">\
                    <div class="avatar">\
                      <img src="https://slelguoygbfzlpylpxfs.supabase.co/storage/v1/object/public/test-clones/cf1c9248-ff3e-4acd-9da1-612b3ed743d8-consulto-promo-bubble-lovable-app/assets/images/consultant-avatar-b1necHKX-1.jpg" alt="–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç">\
                    </div>\
                    <div class="status-indicator"></div>\
                  </div>\
                  <div class="header-text">\
                    <div class="widget-title">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç</div>\
                    <div class="widget-description">–û—Ç–≤–µ—á—É –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –æ–ø–ª–∞—Ç–µ, –¥–æ—Å—Ç–∞–≤–∫–µ, –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –ø–æ–º–æ–≥—É –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç–æ–≤–∞—Ä</div>\
                  </div>\
                </div>\
                <div class="messengers-section">\
                  <div class="section-title">–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±—â–µ–Ω–∏—è</div>\
                  <div class="button-list">\
                    <a href="https://t.me/+79995504322" target="_blank" rel="noopener noreferrer" class="messenger-button">\
                      <div class="messenger-icon icon-telegram">\
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\
                          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-2.05-1.23-2.12-1.29-.02-.02-.34-.44.84-1.53 1.12-1.02 2.2-2.15 2.5-2.58.06-.09-.07-.27-.26-.2-.79.28-3.08 1.69-4.87 2.68-.31.17-.67.24-1.03.22-.38-.02-1.1-.22-1.63-.38-.66-.2-1.18-.4-1.13-.85.02-.23.36-.45.98-.68 3.86-1.68 6.43-2.78 7.71-3.31 3.66-1.5 4.42-1.76 4.91-1.77.11 0 .35.03.51.16.14.11.18.26.2.37.02.13.02.26 0 .4z"/>\
                        </svg>\
                      </div>\
                      <span class="messenger-text telegram">Telegram</span>\
                    </a>\
                    <a href="https://api.whatsapp.com/send/?phone=79995504322" target="_blank" rel="noopener noreferrer" class="messenger-button">\
                      <div class="messenger-icon icon-whatsapp">\
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\
                          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>\
                        </svg>\
                      </div>\
                      <span class="messenger-text whatsapp">WhatsApp</span>\
                    </a>\
                    <button class="messenger-button" onclick="window.consultantWidgetOpenChat()" ' + (chat2deskStatus !== 'ready' ? 'disabled' : '') + '>\
                      <div class="messenger-icon icon-chat">' + chatIconContent + '</div>\
                      <div class="messenger-text-wrapper">\
                        <span class="messenger-text chat">–û–Ω–ª–∞–π–Ω-—á–∞—Ç –Ω–∞ —Å–∞–π—Ç–µ</span>' + chatStatus + '\
                      </div>\
                    </button>\
                  </div>\
                </div>\
                <div class="section-title">–ú—ã –≤—Å–µ–≥–¥–∞ —Ä–∞–¥—ã –ø–æ–º–æ—á—å –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É</div>\
                <div class="phone-grid">\
                  <a href="tel:88006004322" class="phone-button">\
                    <svg class="phone-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\
                      <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>\
                    </svg>\
                    <div class="phone-number">8 800 600 43 22</div>\
                    <div class="phone-label">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</div>\
                  </a>\
                  <a href="tel:+79684994322" class="phone-button">\
                    <svg class="phone-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\
                      <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>\
                    </svg>\
                    <div class="phone-number">+7 968 499 43 22</div>\
                    <div class="phone-label">–°–ª—É–∂–±–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏</div>\
                  </a>\
                </div>\
              </div>';
        }
      }

      window.consultantWidgetToggle = toggleOpen;
      window.consultantWidgetClose = handleClose;
      window.consultantWidgetOpenChat = openChat2Desk;

      document.addEventListener('initialize_widget', function() {
        console.log('[Chat2Desk] üì¶ initialize_widget: –≤–∏–¥–∂–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω');
        setTimeout(function() {
          var chatButtons = document.querySelectorAll('.startBtn, .startBtn__button, button.startBtn__button, [class*="startBtn"]');
          chatButtons.forEach(function(btn) {
            btn.style.cssText = 'display: none !important; visibility: hidden !important; pointer-events: none !important;';
          });
          console.log('[Chat2Desk] ‚úÖ –ö–Ω–æ–ø–∫–∏ —Å–∫—Ä—ã—Ç—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏:', chatButtons.length);
        }, 500);
      });

        document.addEventListener('initialize_client', function() {
          console.log('[Chat2Desk] üü¢ initialize_client: –æ–∫–Ω–æ —á–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–æ');
          var overlay = document.querySelector('.overlay');
          var card = document.querySelector('.widget-card');
          if (overlay) overlay.style.display = 'none';
          if (card) card.style.display = 'none';
          isOpen = false;
        });

        var chatCloseObserver = new MutationObserver(function() {
          var chatContainer = document.getElementById('chat24-iframe-container');
          if (chatContainer) {
            var display = window.getComputedStyle(chatContainer).display;
            if (display === 'none') {
              console.log('[Chat2Desk] üî¥ –ß–∞—Ç –∑–∞–∫—Ä—ã—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∏–¥–∂–µ—Ç-–≤–∏–∑–∏—Ç–∫—É');
              isOpen = true;
              updateWidget();
            }
          }
        });

      setTimeout(function() {
        var chatContainer = document.getElementById('chat24-iframe-container');
        if (chatContainer) {
          chatCloseObserver.observe(chatContainer, { attributes: true, attributeFilter: ['style'] });
        }
      }, 3000);

      window.chat2deskDebug = function() {
        console.log('=== –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê CHAT2DESK ===');
        console.log('instanceId:', instanceId);
        console.log('position:', position);
        console.log('storageKey:', CLOSE_STORAGE_KEY);
        console.log('–°—Ç–∞—Ç—É—Å:', chat2deskStatus);
        console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω:', chat2deskInitialized);
        console.log('window.chat2desk:', window.chat2desk);
        console.log('–≠–ª–µ–º–µ–Ω—Ç—ã DOM:');
        console.log('  - #chat24-button:', document.getElementById('chat24-button'));
        console.log('  - #chat24-iframe-container:', document.getElementById('chat24-iframe-container'));
        console.log('  - [id^="chat24"]:', document.querySelectorAll('[id^="chat24"]'));
        console.log('–ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–∫—Ä—ã—Ç—å —á–∞—Ç –≤—Ä—É—á–Ω—É—é...');
        document.dispatchEvent(new CustomEvent('popups:open'));
      };

        setTimeout(function() {
          isVisible = true;
          updateWidget();
          initChat2Desk();
          console.log('[Consultant Widget] Initialized after 3s delay');
        }, 3000);

      window.consultantWidgetReset = function() {
        try {
          localStorage.removeItem(CLOSE_STORAGE_KEY);
        } catch (e) {
          // ignore
        }
        location.reload();
      };

      console.log('üí° –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: chat2deskDebug()');
      console.log('üí° –°–±—Ä–æ—Å –≤–∏–¥–∂–µ—Ç–∞: consultantWidgetReset()');
    })();
  </script>
</body>
</html>
